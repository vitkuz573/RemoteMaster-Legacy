@page "/Account/Manage/GenerateRecoveryCodes"

@using Microsoft.AspNetCore.Identity
@using RemoteMaster.Server.Data

@inject UserManager<ApplicationUser> UserManager
@inject IdentityUserAccessor UserAccessor
@inject IdentityRedirectManager RedirectManager

<PageTitle>Generate two-factor authentication (2FA) recovery codes</PageTitle>

@if (_recoveryCodes is not null)
{
    <ShowRecoveryCodes RecoveryCodes="_recoveryCodes.ToArray()" StatusMessage="@_message" />
}
else
{
    <div class="space-y-6">
        <h3 class="leading-6 text-lg font-medium text-gray-900">Generate two-factor authentication (2FA) recovery codes</h3>
        <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M8.257 3.099c.366-.446.941-.697 1.543-.697s1.177.251 1.543.697l5.714 7.007c.687.841.687 2.03 0 2.871L11.343 19.9c-.366.446-.941.697-1.543.697s-1.177-.251-1.543-.697L2.543 13.078c-.687-.841-.687-2.03 0-2.871L8.257 3.099zM10 12.5a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" clip-rule="evenodd" />
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-yellow-800">
                        Put these codes in a safe place.
                    </h3>
                    <div class="mt-2 text-sm text-yellow-700">
                        <p>
                            If you lose your device and don't have the recovery codes you will lose access to your account.
                        </p>
                        <p>
                            Generating new recovery codes does not change the keys used in authenticator apps. If you wish to change the key
                            used in an authenticator app you should <a href="Account/Manage/ResetAuthenticator" class="text-indigo-600">reset your authenticator keys</a>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div>
            <form @formname="generate-recovery-codes" @onsubmit="OnSubmitAsync" method="post">
                <AntiforgeryToken />
                <button type="submit" class="w-full rounded-md bg-red-600 px-4 py-2 text-white hover:bg-red-700 focus:outline-none">Generate Recovery Codes</button>
            </form>
        </div>
    </div>
}