@page "/Account/Manage/ResetAuthenticator"

@using Microsoft.AspNetCore.Identity
@using RemoteMaster.Server.Data

@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject IdentityUserAccessor UserAccessor
@inject IdentityRedirectManager RedirectManager

<PageTitle>Reset authenticator key</PageTitle>

<StatusMessage />
<div class="space-y-6">
    <h3 class="leading-6 text-lg font-medium text-gray-900">Reset authenticator key</h3>
    <div class="border-l-4 border-yellow-400 bg-yellow-50 p-4">
        <div class="flex">
            <div class="flex-shrink-0">
                <svg class="h-6 w-6 text-yellow-400" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10c0 4.418-3.582 8-8 8S2 14.418 2 10 5.582 2 10 2s8 3.582 8 8zm-8.93-3.66a1.3 1.3 0 112.6 0v3.25a1.3 1.3 0 11-2.6 0V6.34zM10 13.5a1.25 1.25 0 100 2.5 1.25 1.25 0 000-2.5z" clip-rule="evenodd" />
                </svg>
            </div>
            <div class="ml-3">
                <h3 class="text-sm font-medium text-yellow-800">
                    If you reset your authenticator key your authenticator app will not work until you reconfigure it.
                </h3>
                <div class="mt-2 text-sm text-yellow-700">
                    <p>
                        This process disables 2FA until you verify your authenticator app.
                        If you do not complete your authenticator app configuration you may lose access to your account.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div>
        <form @formname="reset-authenticator" @onsubmit="OnSubmitAsync" method="post">
            <AntiforgeryToken />
            <button type="submit" class="w-full rounded-md bg-red-600 px-4 py-2 text-white hover:bg-red-700 focus:outline-none">Reset authenticator key</button>
        </form>
    </div>
</div>