@inherits CommonDialogBase

@using Microsoft.AspNetCore.Identity
@using RemoteMaster.Server.Abstractions
@using RemoteMaster.Server.Aggregates.ApplicationUserAggregate
@using RemoteMaster.Server.Aggregates.OrganizationAggregate
@using RemoteMaster.Server.Aggregates.OrganizationalUnitAggregate
@using RemoteMaster.Server.Data
@using RemoteMaster.Server.Entities
@using RemoteMaster.Server.Services

@inject UserManager<ApplicationUser> UserManager
@inject IOrganizationRepository OrganizationRepository
@inject IOrganizationalUnitRepository OrganizationalUnitRepository
@inject IOrganizationalUnitService OrganizationalUnitService

<CommonDialog>
    <Content>
        @if (!string.IsNullOrWhiteSpace(_currentOrganizationName))
        {
            <MudText Typo="Typo.body1">Current Organization: @_currentOrganizationName</MudText>
        }

        @if (!string.IsNullOrWhiteSpace(_currentOrganizationalUnitName))
        {
            <MudText Typo="Typo.body1">Current Organizational Unit: @_currentOrganizationalUnitName</MudText>
        }

        <MudSelect Label="Select target organization" Value="_selectedOrganizationId" T="Guid" ValueChanged="OrganizationChanged" Dense="true">
            @foreach (var organization in _organizations)
            {
                <MudSelectItem Value="@organization.Id">@organization.Name</MudSelectItem>
            }
        </MudSelect>

        @if (_organizationalUnits.Any())
        {
            <MudSelect Label="Select target organizational unit" @bind-Value="_selectedOrganizationalUnitId" T="Guid?" Dense="true">
                @foreach (var organizationalUnit in _organizationalUnits)
                {
                    <MudSelectItem T="Guid?" Value="@organizationalUnit.Id">
                        @organizationalUnit.Name
                    </MudSelectItem>
                }
            </MudSelect>
        }
    </Content>
    <Actions>
        <MudButton Color="Color.Primary" OnClick="MoveHost" Disabled="_selectedOrganizationalUnitId == null">Move</MudButton>
    </Actions>
</CommonDialog>
